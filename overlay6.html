<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    font-size: 40px;
    color: white;
    background: transparent;
  }
  #names {
    position: absolute;
    top: 50px;
    left: 50px;
    text-shadow: 2px 2px 4px black;
  }
  .top-name {
    color: pink; /* alleen de bovenste naam roze */
  }
</style>
</head>
<body>

<div id="names">Wachtrij wordt geladenâ€¦</div>

<script>
async function updateNames() {
  const sheetId = '1bT7pAzYvwI9Txo2iQ9BMtcJmvhIEh2TSrmPgKddkmtE'; // jouw Sheet ID
  const sheetName = 'Blad1';
  const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

  try {
    const res = await fetch(url);
    const text = await res.text();

    let json;
    try {
      json = JSON.parse(text.substr(47).slice(0, -2));
    } catch {
      console.error("Fout bij parsen van Sheet JSON");
      document.getElementById('names').textContent = "Geen wachtrij momenteel";
      return;
    }

    // Haal alleen kolom A op, filter lege rijen
    const rows = (json.table.rows || [])
      .map(r => r.c[0]?.v)
      .filter(Boolean);

    // Maak HTML met bovenste naam roze, de rest wit
    let html = '';
    rows.forEach((name, i) => {
      if(i === 0) {
        html += `<span class="top-name">${name}</span><br>`;
      } else {
        html += `${name}<br>`;
      }
    });

    document.getElementById('names').innerHTML = rows.length ? html : "Geen wachtrij momenteel";

  } catch (e) {
    console.error('Fout bij ophalen Sheet:', e);
    document.getElementById('names').textContent = "Geen wachtrij momenteel";
  }
}

// Update elke 3 seconden
setInterval(updateNames, 3000);
updateNames();
</script>

</body>
</html>